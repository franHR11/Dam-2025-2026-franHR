<!doctype html>
<html>
    <head>
        <style>
            canvas {
                border: 1px solid #d35400;
            }
        </style>
    </head>
    <body>
        <canvas width=512 height=512></canvas>
        <script>
            const lienzo = document.querySelector("canvas");
            const contexto = lienzo.getContext("2d");
            
            class Particula {
                constructor() {
                    this.posicionX = Math.random() * 512;
                    this.posicionY = Math.random() * 512;
                    this.angulo = Math.random() * Math.PI * 2;
                }
                
                dibujar() {
                    contexto.beginPath();
                    contexto.arc(this.posicionX, this.posicionY, 5, 0, Math.PI * 2)
                    contexto.fillStyle = "#e67e22";
                    contexto.fill()
                }
                
                mover() {
                    // Actualizar dirección y posición
                    this.angulo += (Math.random() - 0.5) * 0.5
                    this.posicionX += Math.cos(this.angulo)
                    this.posicionY += Math.sin(this.angulo)
                }
                
                detectarColision() {
                    // Comprobar colisiones con los bordes del canvas
                    if(
                        this.posicionX < 0 || 
                        this.posicionX > 512 || 
                        this.posicionY < 0 || 
                        this.posicionY > 512
                    ) {
                        this.angulo += Math.PI
                    }
                }
                
                obtenerPosicion() {
                    // Devolver objeto con coordenadas actuales
                    return {
                        "x": this.posicionX,
                        "y": this.posicionY
                    }
                }
            }
            
            let arrayParticulas = []
            let cantidadParticulas = 100;
            
            // Crear partículas iniciales
            for(let i = 0; i < cantidadParticulas; i++) {
                arrayParticulas.push(new Particula())
            }
            
            let temporizadorAnim = setTimeout("actualizarEscena()", 1000)
            
            function actualizarEscena() { 
                contexto.clearRect(0, 0, 512, 512)
                
                // Actualizar y dibujar todas las partículas
                arrayParticulas.forEach(function(particula) {
                    particula.detectarColision();
                    particula.mover();
                    particula.dibujar();
                })
                
                // Detectar colisiones entre partículas
                for(let i = 0; i < arrayParticulas.length; i++) {
                    for(let j = 0; j < arrayParticulas.length; j++) {
                        if(i != j) {
                            // Calcular distancia entre partículas
                            if(
                                Math.abs(arrayParticulas[i].obtenerPosicion().x - arrayParticulas[j].obtenerPosicion().x) < 10
                                &&
                                Math.abs(arrayParticulas[i].obtenerPosicion().y - arrayParticulas[j].obtenerPosicion().y) < 10
                            ) {
                                // Invertir dirección al colisionar
                                arrayParticulas[i].angulo += Math.PI
                                arrayParticulas[j].angulo += Math.PI
                            }
                        }
                    }
                }
                
                // Programar siguiente frame
                clearTimeout(temporizadorAnim)
                temporizadorAnim = setTimeout("actualizarEscena()", 10)
            }
        </script>
    </body>
</html>

