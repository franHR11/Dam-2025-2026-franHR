<!doctype html>
<html lang="es">
  <meta charset="utf-8" />
  <title>Gesti칩n de Clientes con Voz</title>
  <style>
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background-color: #4CAF50; color: white; }
    tr:hover { background-color: #f5f5f5; }
  </style>
  <button id="start" style="background-color: #FF5722; color: white; padding: 12px; margin: 10px; border-radius: 4px;">游꿗 Iniciar Grabaci칩n</button>
  <div id="out" style="margin: 15px; padding: 10px; background-color: #e8f5e9; border-radius: 4px;"></div>
  <div id="contenedor"></div>
  <script>
    const usuarios = [
      {"nombre":"Antonio","apellidos":"Mart칤nez Ruiz","email":"antonio.martinez@correo.es"},
      {"nombre":"Carmen","apellidos":"S치nchez L칩pez","email":"carmen.sanchez@correo.es"},
      {"nombre":"Miguel","apellidos":"Fern치ndez Torres","email":"miguel.fernandez@correo.es"}
    ]
    
    function mostrarTabla(){
      let contenidoHTML = "<table><tr><th>Nombre</th><th>Apellidos</th><th>Email</th></tr>"
      usuarios.forEach(function(usuario){
        contenidoHTML += "<tr><td>"+usuario.nombre+"</td><td>"+usuario.apellidos+"</td><td>"+usuario.email+"</td></tr>"
      })
      contenidoHTML += "</table>"
      document.querySelector("#contenedor").innerHTML = contenidoHTML
    }
    mostrarTabla()

    let voces = [];
    function buscarVozEspa침ola() {
      const vozSeleccionada = voces.find(v => /es-|Spanish/i.test(v.lang)) || voces[0];
      return vozSeleccionada || null;
    }
    function inicializarVoces() {
      voces = speechSynthesis.getVoices();
    }
    inicializarVoces();
    speechSynthesis.onvoiceschanged = inicializarVoces;

    const ReconocimientoVoz = window.SpeechRecognition || window.webkitSpeechRecognition;
    const reconocedor = new ReconocimientoVoz();
    reconocedor.lang = "es-ES";
    reconocedor.interimResults = false;
    
    reconocedor.onresult = function(evento){ 
      const textoReconocido = evento.results[0][0].transcript;
      document.getElementById("out").textContent = textoReconocido;
      
      const mensajeVoz = new SpeechSynthesisUtterance(textoReconocido);
      const vozElegida = buscarVozEspa침ola();
      if (vozElegida) mensajeVoz.voice = vozElegida;
      mensajeVoz.lang = (vozElegida && vozElegida.lang) || 'es-ES';
      speechSynthesis.cancel();
      speechSynthesis.speak(mensajeVoz);
    }
    
    document.getElementById("start").onclick = () => reconocedor.start();
  </script>
</html>

